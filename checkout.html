<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Border Goods Shopper | Shop in Malaba, Teso & Busia</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Malaba border market, Teso County e-commerce, Busia County online shop, Border goods Kenya, Cross-border shopping Malaba, Fun-Corp Developers" name="keywords">
    <meta content="Border Goods Shopper, developed by Fun-Corp Developers, offers a seamless shopping experience for residents of Malaba, Teso, and Busia County. Discover local and cross-border products at unbeatable prices." name="description">
    
    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    <style>
        .fixed-topbar {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='rgba%2850,50,50,1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
        }

        .search-bar {
            position: relative;
            margin: 0 auto;
            max-width: 600px;
        }

        .input-group-text {
            background-color: #007bff;
            color: white;
        }
        .bargain-container {
            position: relative;
            margin-top: 20px;
            text-align: center;
        }

        .percentage-display {
            font-size: 48px;
            font-weight: bold;
            color: #007bff;
            transition: color 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .animation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .animation-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            text-align: center;
            animation: popIn 0.5s ease-out;
        }

        .final-message {
            margin-top: 20px;
            font-size: 18px;
            color: #28a745;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

    </style>
</head>

<body>
    <!-- Topbar Start -->
    <div class="container-fluid fixed-topbar">
        <div class="row bg-secondary py-2 px-xl-5">
            <div class="col-lg-6 d-none d-lg-block">
                <div class="d-inline-flex align-items-center">
                    <a class="text-dark" href="">FAQs</a>
                    <span class="text-muted px-2">|</span>
                    <a class="text-dark" href="">Help</a>
                    <span class="text-muted px-2">|</span>
                    <a class="text-dark" href="">Support</a>
                </div>
            </div>
            <div class="col-lg-6 text-center text-lg-right">
                <div class="d-flex justify-content-between">
                    <div class="d-inline-flex align-items-center">
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a class="text-dark pl-2" href="">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                    <div class="p-0 text-center m-0">
                        <button type="button" class="navbar-toggler p-0 mb-0" data-toggle="collapse" data-target="#navbarCollapse">
                            <i class="fa fa-bars"></i>
                        </button><br>
                        <span style="font-size: 10px;">menu</span>
                    </div>
                </div>
                <!-- Collapsible menu for additional links -->
                <div class="collapse" id="navbarCollapse">
                    <div class="navbar-nav ml-auto py-0">
                        <a href="index.html" class="nav-item nav-link active">Home</a>
                        <a href="shops.html" class="nav-item nav-link">Shop</a>
                        <a href="contact.html" class="nav-item nav-link">Contact</a>
                        <a href="#" class="nav-item nav-link">Login</a>
                        <a href="#" class="nav-item nav-link">Register</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row align-items-center px-xl-5">
            <div class="col-lg-3 d-none d-lg-block">
                <a href="index.html" class="text-decoration-none">
                    <img src="img/main-logo.png" alt="logo" style="height: 60px; width: 80%">
                </a>
            </div>
            <div class="col-lg-6 col-9">
                <form action="">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search for products">
                        <div class="input-group-append">
                            <span class="input-group-text bg-transparent text-primary">
                                <i class="fa fa-search"></i>
                            </span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-lg-3 col-3 text-right d-flex justify-content-between">
                <a href="cart.html" class="btn border d-flex justify-content-between">
                    <i class="fas fa-shopping-cart text-primary"></i>
                    <span id="cart-count" class="badge">0</span>
                </a>
            </div>
        </div>
    </div>
    <!-- Topbar End -->

    <!-- Cart Start -->
    <div id="cart-items-container" class="container" style="margin-top: 150px;">
        <div class="row">
            <div class="col-md-4">
                <h5 class="">Maximum Waiting Time: 30 Minutes</h5>
                <label for="payMethod" class="form-control border-0">Please select payment method: </label>
                <select name="pay_method" id="payMethod" class="form-control">
                    <option selected disabled>---select here---</option>
                    <option value="cash">Cash</option>
                    <option value="mpesa">Mpesa</option>
                </select>
                <div class="form-group">
                    <label for="burgainMode" class="form-control border-0">Bargain mode: </label>
                    <!-- <select name="burgainMode" id="burgain_mode" class="form-control">
                        <option selected disabled>---select here---</option>
                        <option value="50">50/-</option>
                        <option value="100">100/-</option>
                    </select> -->
                    <button  class="btn form-control" id="burgain_mode"> Burgain</button>
                </div>
                <!-- Add the animation overlay -->
                <div class="animation-overlay">
                    <div class="animation-content">
                        <div class="percentage-display">0%</div>
                        <div class="final-message">Congratulations! You got a 10% discount!</div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                
                <label for="pickupStation" class="form-control border-0">Please select how you will get your product: </label>
                <select name="pickup_station" id="pickupStation" class="form-control">
                    <option selected disabled>---select here---</option>
                    <option value="shop">Shop</option>
                    <option value="doorstep">Doorstep delivery</option>
                </select>
                <iframe min-width="100%" width="100%" height="250" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox=34.76887464523316%2C-0.07462976252758229%2C34.78531122207642%2C-0.06158350712432609&amp;layer=mapnik&amp;marker=-0.06810663526735157%2C34.777092933654785" style="border: 1px solid black"></iframe><br/><small><a href="https://www.openstreetmap.org/?mlat=-0.0681&amp;mlon=34.7771#map=16/-0.0681/34.7771">View Larger Map</a></small>
            </div>
            <div class="col-md-4">
                <div id="cart-summary" class="text-right">
                    <h4>Cart Summary</h4>
                    <p>Subtotal: <span id="cart-subtotal" class="font-weight-bold">Kshs. 0.00</span></p>
                    <button id="checkout-btn" class="btn btn-primary text-light font-weight-bold">Proceed to Checkout</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Cart End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const pickupStation = document.getElementById('pickupStation');
            const iframe = document.querySelector('iframe');
        
            pickupStation.addEventListener('change', () => {
                const selectedOption = pickupStation.value;
        
                if (selectedOption === 'doorstep') {
                    // Initially hide the iframe while getting coordinates
                    iframe.style.display = 'none';
        
                    if (navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(
                            (position) => {
                                const { latitude, longitude } = position.coords;
        
                                // Store coordinates in localStorage
                                localStorage.setItem('deliveryCoordinates', JSON.stringify({ latitude, longitude }));
        
                                // Calculate the bounding box for better map visibility
                                // Using a slightly larger offset for better view
                                const offset = 0.002; // Approximately 200 meters
                                const bbox = {
                                    west: longitude - offset,
                                    south: latitude - offset,
                                    east: longitude + offset,
                                    north: latitude + offset
                                };
        
                                // Construct the OpenStreetMap URL with proper encoding
                                const mapUrl = `https://www.openstreetmap.org/export/embed.html?` +
                                    `bbox=${bbox.west.toFixed(6)}%2C${bbox.south.toFixed(6)}%2C` +
                                    `${bbox.east.toFixed(6)}%2C${bbox.north.toFixed(6)}` +
                                    `&layer=mapnik` +
                                    `&marker=${latitude.toFixed(6)}%2C${longitude.toFixed(6)}`;
        
                                // Update iframe source
                                iframe.src = mapUrl;
                                iframe.style.display = 'block';
        
                                console.log('Map URL:', mapUrl); // For debugging
                                console.log(`Coordinates saved: Latitude ${latitude}, Longitude ${longitude}`);
                            },
                            (error) => {
                                console.error('Error fetching location:', error);
                                alert('Unable to fetch location. Please ensure location access is allowed.');
                            },
                            {
                                // Options for better accuracy
                                enableHighAccuracy: true,
                                timeout: 5000,
                                maximumAge: 0
                            }
                        );
                    } else {
                        alert('Geolocation is not supported by your browser.');
                    }
                } else if (selectedOption === 'shop') {
                    // Restore the default shop location iframe
                    iframe.src = "https://www.openstreetmap.org/export/embed.html?bbox=34.76887464523316%2C-0.07462976252758229%2C34.78531122207642%2C-0.06158350712432609&layer=mapnik&marker=-0.06810663526735157%2C34.777092933654785";
                    iframe.style.display = 'block';
                }
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const bargainButton = document.getElementById('burgain_mode');
            const overlay = document.querySelector('.animation-overlay');
            const percentageDisplay = document.querySelector('.percentage-display');
            const finalMessage = document.querySelector('.final-message');
            
            let animationInterval;
            let currentValue = 0;
            let direction = 1;
            let cycles = 0;
            const maxCycles = 2;

            function updateDisplay(value) {
                percentageDisplay.textContent = `${Math.round(value)}%`;
                percentageDisplay.style.color = `hsl(${value * 2}, 70%, 50%)`;
            }

            function resetAnimation() {
                clearInterval(animationInterval);
                overlay.style.display = 'none';
                finalMessage.style.opacity = '0';
                currentValue = 0;
                cycles = 0;
                direction = 1;
                bargainButton.disabled = false;
            }

            function startBargainAnimation() {
                overlay.style.display = 'flex';
                percentageDisplay.style.animation = 'none';
                finalMessage.style.opacity = '0';
                bargainButton.disabled = true;
                
                animationInterval = setInterval(() => {
                    currentValue += direction * (Math.random() * 5 + 2);
                    
                    if (currentValue >= 100) {
                        currentValue = 100;
                        direction = -1;
                        cycles++;
                    } else if (currentValue <= 0) {
                        currentValue = 0;
                        direction = 1;
                        cycles++;
                    }
                    
                    updateDisplay(currentValue);
                    
                    if (cycles >= maxCycles) {
                        clearInterval(animationInterval);
                        
                        // Settle to 10% with smooth animation
                        const finalAnimation = setInterval(() => {
                            if (Math.abs(currentValue - 10) < 0.5) {
                                currentValue = 10;
                                clearInterval(finalAnimation);
                                percentageDisplay.style.animation = 'pulse 1s ease infinite';
                                finalMessage.style.opacity = '1';
                                
                                // Auto close after 3 seconds
                                setTimeout(() => {
                                    resetAnimation();
                                }, 3000);
                            } else {
                                currentValue += (10 - currentValue) * 0.1;
                                updateDisplay(currentValue);
                            }
                        }, 50);
                    }
                }, 50);
            }

            bargainButton.addEventListener('click', () => {
                resetAnimation();
                startBargainAnimation();
            });

            // Close overlay when clicking outside the animation content
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    resetAnimation();
                }
            });
        });
    </script>
</body>

</html>
